<!DOCTYPE html>
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
<link rel="apple-touch-icon" href="../../wp-content/themes/mantra_custom/images/favicon/apple-touch-icon.html" />
<link rel="profile" href="https://gmpg.org/xfn/11" />
<link rel="pingback" href="../../xmlrpc.php" />
<title>PatridgeDev &#8211; Page 5 &#8211; Software developer obsessed with helping others do more with training, tooling, and automation.</title>
<link rel='dns-prefetch' href='https://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="PatridgeDev &raquo; Feed" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="PatridgeDev &raquo; Comments Feed" href="../../comments/feed/index.html" />
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.5.2 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="https://www.googletagmanager.com/gtag/js?id=UA-24616833-1"  data-cfasync="false" data-wpfc-render="false" type="text/javascript" async></script>
			<script data-cfasync="false" data-wpfc-render="false" type="text/javascript">
				var mi_version = '8.5.2';
				var mi_track_user = true;
				var mi_no_track_reason = '';
				
								var disableStrs = [
										'ga-disable-G-3WN7RP75N7',
															'ga-disable-UA-24616833-1',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for ( var index = 0; index < disableStrs.length; index++ ) {
						if ( document.cookie.indexOf( disableStrs[ index ] + '=true' ) > -1 ) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if ( __gtagTrackerIsOptedOut() ) {
					for ( var index = 0; index < disableStrs.length; index++ ) {
						window[ disableStrs[ index ] ] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for ( var index = 0; index < disableStrs.length; index++ ) {
						document.cookie = disableStrs[ index ] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[ disableStrs[ index ] ] = true;
					}
				}

				if ( 'undefined' === typeof gaOptout ) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if ( mi_track_user ) {
					function __gtagDataLayer() {
						dataLayer.push( arguments );
					}

					function __gtagTracker( type, name, parameters ) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply( null, arguments );
							return;
						}

						if ( type === 'event' ) {
															parameters.send_to = monsterinsights_frontend.v4_id;
								var hookName = name;
								if ( typeof parameters[ 'event_category' ] !== 'undefined' ) {
									hookName = parameters[ 'event_category' ] + ':' + name;
								}

								if ( typeof MonsterInsightsDualTracker.trackers[ hookName ] !== 'undefined' ) {
									MonsterInsightsDualTracker.trackers[ hookName ]( parameters );
								} else {
									__gtagDataLayer( 'event', name, parameters );
								}
							
															parameters.send_to = monsterinsights_frontend.ua;
								__gtagDataLayer( type, name, parameters );
													} else {
							__gtagDataLayer.apply( null, arguments );
						}
					}
					__gtagTracker( 'js', new Date() );
					__gtagTracker( 'set', {
						'developer_id.dZGIzZG' : true,
											} );
										__gtagTracker( 'config', 'G-3WN7RP75N7', {"forceSSL":"true","link_attribution":"true"} );
															__gtagTracker( 'config', 'UA-24616833-1', {"forceSSL":"true","link_attribution":"true"} );
										window.gtag = __gtagTracker;											(function () {
							/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
							/* ga and __gaTracker compatibility shim. */
							var noopfn = function () {
								return null;
							};
							var newtracker = function () {
								return new Tracker();
							};
							var Tracker = function () {
								return null;
							};
							var p = Tracker.prototype;
							p.get = noopfn;
							p.set = noopfn;
							p.send = function (){
								var args = Array.prototype.slice.call(arguments);
								args.unshift( 'send' );
								__gaTracker.apply(null, args);
							};
							var __gaTracker = function () {
								var len = arguments.length;
								if ( len === 0 ) {
									return;
								}
								var f = arguments[len - 1];
								if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
									if ( 'send' === arguments[0] ) {
										var hitConverted, hitObject = false, action;
										if ( 'event' === arguments[1] ) {
											if ( 'undefined' !== typeof arguments[3] ) {
												hitObject = {
													'eventAction': arguments[3],
													'eventCategory': arguments[2],
													'eventLabel': arguments[4],
													'value': arguments[5] ? arguments[5] : 1,
												}
											}
										}
										if ( 'pageview' === arguments[1] ) {
											if ( 'undefined' !== typeof arguments[2] ) {
												hitObject = {
													'eventAction': 'page_view',
													'page_path' : arguments[2],
												}
											}
										}
										if ( typeof arguments[2] === 'object' ) {
											hitObject = arguments[2];
										}
										if ( typeof arguments[5] === 'object' ) {
											Object.assign( hitObject, arguments[5] );
										}
										if ( 'undefined' !== typeof arguments[1].hitType ) {
											hitObject = arguments[1];
											if ( 'pageview' === hitObject.hitType ) {
												hitObject.eventAction = 'page_view';
											}
										}
										if ( hitObject ) {
											action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
											hitConverted = mapArgs( hitObject );
											__gtagTracker( 'event', action, hitConverted );
										}
									}
									return;
								}

								function mapArgs( args ) {
									var arg, hit = {};
									var gaMap = {
										'eventCategory': 'event_category',
										'eventAction': 'event_action',
										'eventLabel': 'event_label',
										'eventValue': 'event_value',
										'nonInteraction': 'non_interaction',
										'timingCategory': 'event_category',
										'timingVar': 'name',
										'timingValue': 'value',
										'timingLabel': 'event_label',
										'page' : 'page_path',
										'location' : 'page_location',
										'title' : 'page_title',
									};
									for ( arg in args ) {
																				if ( ! ( ! args.hasOwnProperty(arg) || ! gaMap.hasOwnProperty(arg) ) ) {
											hit[gaMap[arg]] = args[arg];
										} else {
											hit[arg] = args[arg];
										}
									}
									return hit;
								}

								try {
									f.hitCallback();
								} catch ( ex ) {
								}
							};
							__gaTracker.create = newtracker;
							__gaTracker.getByName = newtracker;
							__gaTracker.getAll = function () {
								return [];
							};
							__gaTracker.remove = noopfn;
							__gaTracker.loaded = true;
							window['__gaTracker'] = __gaTracker;
						})();
									} else {
										console.log( "" );
					( function () {
							function __gtagTracker() {
								return null;
							}
							window['__gtagTracker'] = __gtagTracker;
							window['gtag'] = __gtagTracker;
					} )();
									}
			</script>
				<!-- / Google Analytics by MonsterInsights -->
				<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.patridgedev.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.11"}};
			/*! This file is auto-generated */
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../wp-includes/css/dist/block-library/style.mine6b3.css?ver=5.4.11' type='text/css' media='all' />
<link rel='stylesheet' id='mantra-style-css'  href='../../wp-content/themes/mantra.3.2.0_custom/style55a0.css?ver=3.2.0' type='text/css' media='all' />
<style id='mantra-style-inline-css' type='text/css'>
 #wrapper { max-width: 1140px; } #content { width: 100%; max-width:800px; max-width: calc( 100% - 340px ); } #primary, #secondary { width:340px; } #primary .widget-title, #secondary .widget-title { margin-right: -2em; text-align: left; } html { font-size:15px; } body, input, textarea {font-family:"Open Sans"; } #content h1.entry-title a, #content h2.entry-title a, #content h1.entry-title, #content h2.entry-title, #front-text1 h2, #front-text2 h2 {font-family: "Merriweather"; } .widget-area {font-family:"Open Sans"; } .entry-content h1, .entry-content h2, .entry-content h3, .entry-content h4, .entry-content h5, .entry-content h6 {font-family:"Merriweather"; } .nocomments, .nocomments2 {display:none;} #header-container > div { margin-top:30px; } #header-container > div { margin-left:30px; } body { background-color:#444444 !important; } #header { background-color:#333333; } #footer { background-color:#222222; } #footer2 { background-color:#171717; } #site-title span a { color:#0D85CC; } #site-description { color:#999999; } #content { color:#555555 ;} .widget-area a:link, .widget-area a:visited, a:link, a:visited ,#searchform #s:hover, #container #s:hover, #access a:hover, #wp-calendar tbody td a, #site-info a, #site-copyright a, #access li:hover > a, #access ul ul:hover > a { color:#0D85CC; } a:hover, .entry-meta a:hover, .entry-utility a:hover, .widget-area a:hover { color:#12a7ff; } #content .entry-title a, #content .entry-title, #content h1, #content h2, #content h3, #content h4, #content h5, #content h6 { color:#444444; } #content .entry-title a:hover { color:#000000; } .widget-title { background-color:#444444; } .widget-title { color:#FFFFFF; } #footer-widget-area .widget-title { color:#FFFFFF; } #footer-widget-area a { color:#666666; } #footer-widget-area a:hover { color:#888888; } .png); } .entry-content p:not(:last-child), .entry-content ul, .entry-summary ul, .entry-content ol, .entry-summary ol { margin-bottom:1.5em;} .entry-meta .entry-time { display:none; } #branding { height:125px ;} 
/* Mantra Custom CSS */
</style>
<link rel='stylesheet' id='mantra-googlefont-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A400%2C700&amp;ver=5.4.11' type='text/css' media='all' />
<link rel='stylesheet' id='mantra-googlefont-title-css'  href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700&amp;ver=5.4.11' type='text/css' media='all' />
<link rel='stylesheet' id='mantra-googlefont-side-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A400%2C700&amp;ver=5.4.11' type='text/css' media='all' />
<link rel='stylesheet' id='mantra-googlefont-headings-css'  href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700&amp;ver=5.4.11' type='text/css' media='all' />
<link rel='stylesheet' id='mantra-mobile-css'  href='../../wp-content/themes/mantra.3.2.0_custom/resources/css/style-mobile55a0.css?ver=3.2.0' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend-gtag.min8833.js?ver=8.5.2'></script>
<script data-cfasync="false" data-wpfc-render="false" type="text/javascript" id='monsterinsights-frontend-script-js-extra'>/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/www.patridgedev.com","hash_tracking":"false","ua":"UA-24616833-1","v4_id":"G-3WN7RP75N7"};/* ]]> */
</script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery4a5f.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var mantra_options = {"responsive":"1","image_class":"imageNone","equalize_sidebars":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/themes/mantra.3.2.0_custom/resources/js/frontend55a0.js?ver=3.2.0'></script>
<link rel='https://api.w.org/' href='../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.11" />
<!--[if lte IE 8]> <style type="text/css" media="screen"> #access ul li, .edit-link a , #footer-widget-area .widget-title, .entry-meta,.entry-meta .comments-link, .short-button-light, .short-button-dark ,.short-button-color ,blockquote { position:relative; behavior: url(/wp-content/themes/mantra.3.2.0_custom/resources/js/PIE/PIE.php); } #access ul ul { -pie-box-shadow:0px 5px 5px #999; } #access ul li.current_page_item, #access ul li.current-menu-item , #access ul li ,#access ul ul ,#access ul ul li, .commentlist li.comment ,.commentlist .avatar, .nivo-caption, .theme-default .nivoSlider { behavior: url(/wp-content/themes/mantra.3.2.0_custom/resources/js/PIE/PIE.php); } </style> <![endif]--><!--[if lt IE 9]> 
	<script>
	document.createElement('header');
	document.createElement('nav');
	document.createElement('section');
	document.createElement('article');
	document.createElement('aside');
	document.createElement('footer');
	document.createElement('hgroup');
	</script>
	<![endif]--> 		<style type="text/css" id="wp-custom-css">
			#site-description { text-transform: none; }		</style>
			<link href="https://plus.google.com/103902189108210179119" rel="author" />
</head>
<body class="home blog paged paged-5 mantra-image-none mantra-caption-light mantra-hratio-0 mantra-sidebar-right mantra-menu-left">

    <div id="toTop"><i class="crycon-back2top"></i> </div>
	
<div id="wrapper" class="hfeed">


<header id="header">

		<div id="masthead">

			<div id="branding" role="banner" >

					
	<div id="header-container">
	
				<div>
				<h1 id="site-title">
					<span> <a href="../../index.html" title="PatridgeDev" rel="home">PatridgeDev</a> </span>
				</h1>
				<div id="site-description" >Software developer obsessed with helping others do more with training, tooling, and automation.</div>
			</div> 	<div class="socials" id="sheader"> 
	
			<a target="_blank" rel="nofollow" href="https://twitter.com/patridgedev" class="socialicons social-Twitter" title="Twitter">
				<img alt="Twitter" src="../../wp-content/themes/mantra.3.2.0_custom/resources/images/socials/Twitter.png" />
			</a>
            	</div>
		</div> <!-- #header-container -->
					<div style="clear:both;"></div>

			</div><!-- #branding -->

            <a id="nav-toggle"><span>&nbsp; Menu</span></a>
			<nav id="access" class="jssafe" role="navigation">

					<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
	<div id="prime_nav" class="menu"><ul>
<li ><a href="../../index.html">Home</a></li><li class="page_item page-item-6"><a href="../../about-me/index.html">About Me</a></li>
<li class="page_item page-item-321 page_item_has_children"><a href="../../smudges/index.html">Smudges</a>
<ul class='children'>
	<li class="page_item page-item-336"><a href="../../smudges/smudges-privacy-policy/index.html">Smudges Privacy Policy</a></li>
</ul>
</li>
</ul></div>

			</nav><!-- #access -->

		</div><!-- #masthead -->

	<div style="clear:both;"> </div>

</header><!-- #header -->
<div id="main" class="main">
	<div  id="forbottom" >
			<div class="socials" id="smenur"> 
	
			<a target="_blank" rel="nofollow" href="https://twitter.com/patridgedev" class="socialicons social-Twitter" title="Twitter">
				<img alt="Twitter" src="../../wp-content/themes/mantra.3.2.0_custom/resources/images/socials/Twitter.png" />
			</a>
            	</div>
	
		<div style="clear:both;"> </div>

				<section id="container">

			<div id="content" role="main">


						<nav id="nav-above" class="navigation">
			<div class="nav-previous"><a href="../6/index.html" ><span class="meta-nav">&laquo;</span> Older posts</a></div>
			<div class="nav-next"><a href="../4/index.html" >Newer posts <span class="meta-nav">&raquo;</span></a></div>
		</nav><!-- #nav-above -->
	
								
					
	<article id="post-222" class="post-222 post type-post status-publish format-standard hentry category-dev tag-c-sharp tag-ios tag-monotouch tag-visual-studio">
		<header class="entry-header">	
			<h2 class="entry-title">
				<a href="../../2012/12/10/monotouch-programming-in-visual-studio/index.html" title="Permalink to MonoTouch Programming in Visual Studio" rel="bookmark">
					MonoTouch Programming in Visual Studio				</a>
			</h2>
						<div class="entry-meta">
				 <span class="author vcard" > By  <a class="url fn n" rel="author" href="../../author/adam/index.html" title="View all posts by adam">adam</a> <span class="bl_sep">|</span></span>  <time class="onDate date published" datetime="2012-12-10T14:19:57+00:00"> <a href="../../2012/12/10/monotouch-programming-in-visual-studio/index.html" title="2:19 pm" rel="bookmark"><span class="entry-date">December 10, 2012</span> <span class="entry-time"> - 2:19 pm</span></a> </time><span class="bl_sep">|</span><time class="updated"  datetime="2012-12-10T14:19:57+00:00">December 10, 2012</time> <span class="bl_categ"> <a href="../../category/dev/index.html" rel="tag">dev</a> </span>  							<div class="comments-link">
				<a href="../../2012/12/10/monotouch-programming-in-visual-studio/index.html#respond">Leave a comment</a>			</div>
						</div><!-- .entry-meta -->
			
		
		</header><!-- .entry-header -->
									<div class="entry-content">
						<h2>TL;DR</h2>

<p>Never underestimate the little time sinks of switching between IDEs regularly. To write MonoTouch code in Visual Studio 2010 (debug/deploy still requires MonoDevelop on a Mac), go get <a href="https://github.com/follesoe/VSMonoTouch">VSMonoTouch</a>. If you have any issues getting it going, you may need to toss in some project file tweaks.</p>

<ul>
<li><a href="https://github.com/follesoe/VSMonoTouch/issues/12">Set it to not reference mscorlib.dll</a></li>
<li>Set the <code>System.Web.Services</code> reference to version 2.0.5.0 (and likely any others that may conflict with the latest .NET runtime assemblies).</li>
</ul>

<h2>Background</h2>

<p>I&#8217;ve been programming with MonoTouch for a few months now using MonoDevelop. I really enjoy learning new things (even if MonoTouch saved me from learning Objective-C), but switching IDEs always tosses a few kinks in my productivity. I have tweaked a number of key bindings in MonoDevelop to match Visual Studio, some at the cost of my ability to adapt to the Mac&#8217;s defaults that are normally used everywhere. At one point I switched copy and paste to use Ctrl in MonoDevelop, but then I kept screwing up outside of the IDE. Regardless, I have become fairly productive in MonoDevelop from simply adapting to the new system through repetition (often screwing up when I switch back to Windows now).</p>

<p>I don&#8217;t really have a problem with MonoDevelop most days, but I definitely prefer the Windows system of maneuvering windows and working on multiple displays. Even if I were a Mac-only person, I would hate how full-screen mode works on a Mac. While I have adapted to my new MonoDevelop workflow, I definitely miss having multiple tabs open in a single project; to open multiple instances of MonoDevelop on a Mac, you even need <a href="https://stackoverflow.com/a/6081311/48700">a simple hack</a>. Having to flip around between MonoDevelop and Chrome as I drink from the MonoTouch learning firehose only compounds the window management issue.</p>

<p>Nothing seems to get you around the need for a Mac when testing/debugging/deploying a MonoTouch project, but having Visual Studio as your primary IDE for all your .NET projects can definitely speed things up.</p>

<h2>VSMonoTouch</h2>

<p>Enter <a href="https://github.com/follesoe/VSMonoTouch">VSMonoTouch</a> by Jonas Follesø (<a href="https://github.com/follesoe">follesoe on GitHub</a>).</p>

<p>This Visual Studio VSIX add-in (warning: requires a non-free Visual Studio) seems to create a system for allowing Visual Studio to recognize the MonoTouch framework and its project type and use the correct DLLs for compiling. For simplicity&#8217;s sake, just follow the instructions in the project README for your first run. If that doesn&#8217;t work, start looking for tweaks.</p>

<p>The final process I used was simply moved the VSIX install step from first to last on the instructions list from the README (with absolutely no reason to explain why it worked). Regardless, feel free to try some restarts on the off chance you have issues.</p>

<ol>
<li>Copy the MonoTouch binaries from your Mac development environment to your Visual Studio 2010 development environment. Copy all the files from /Developer/MonoTouch/usr/lib/mono/2.1/ on your Mac to C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework&#46;NETFramework\v1.0 on your PC.</li>
<li>Add a RedistList-folder under your newly created v1.0-folder. Download the FrameworkList.xml file and add it to the RedistList-folder.</li>
<li>Download and run the vsix-package from the github page.</li>
</ol>

<h3>Code Reference Quirks</h3>

<p>It seems that some systems have an easier time getting VSMonoTouch to run than others. On my Windows 7 machine with Visual Studio 2010 (10.0.40219.1 SP1Rel), .NET 4.5, and various Visual Studio 2012 free components; I had a few issues getting things just right. The first three times I tried things out, I simply couldn&#8217;t get Visual Studio to acknowledge the project type. It would load the solution I have from MonoDevelop but leave the projects unloaded.</p>

<p>I tried all sorts of variations on the FrameworkList.xml file and gave up for a while.</p>

<h4>mscorlib</h4>

<p>Today, I decided to try again after I noticed a few updates to <a href="https://github.com/follesoe/VSMonoTouch/issues/12">a project issue with mscorlib</a>. That wasn&#8217;t the issue I was having, but I was hoping anyone trying to solve this issue may accidentally find a solution to help my problem. Oddly, after installing the DLLs first and then the VSIX, it all started loading correctly but with some compile errors and warnings.</p>

<ul>
<li>Error: &#8220;An assembly with the same identity &#8216;mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#8217; has already been imported. Try removing one of the duplicate references.&#8221;</li>
<li>Warning: &#8220;No way to resolve conflict between &#8220;mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#8221; and &#8220;mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#8221;. Choosing &#8220;mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#8243; arbitrarily.&#8221;</li>
<li>Warning: &#8220;There was a mismatch between the processor architecture of the project being built &#8220;MSIL&#8221; and the processor architecture of the reference &#8220;C:\Windows\Microsoft.NET\Framework\v2.0.50727\mscorlib.dll&#8221;, &#8220;x86&#8243;. This mismatch may cause runtime failures. Please consider changing the targeted processor architecture of your project through the Configuration Manager so as to align the processor architectures between your project and references, or take a dependency on references with a processor architecture that matches the targeted processor architecture of your project.&#8221;</li>
<li>Warning: &#8220;Found conflicts between different versions of the same dependent assembly.&#8221;</li>
</ul>

<p>This is where that [mscorlib project issue] came into play. There was a note on the VSMonoTouch README about making sure to have explicit mscorlib references, but I already did. Checking the box on the &#8220;Do not reference mscorlib.dll&#8221; project property, though, removed those errors.</p>

<p><a href="../../wp-content/uploads/2012/12/DoNotReferenceMscorlibDll.png"><img src="../../wp-content/uploads/2012/12/DoNotReferenceMscorlibDll-150x150.png" alt="VSMonoTouch mscorlib.dll issue fix" title="DoNotReferenceMscorlibDll" width="150" height="150" class="aligncenter size-thumbnail wp-image-230" /></a></p>

<p>If you are a fan of tweaking csproj XML directly instead of through the project properties editor, feel free to add this node to any compilation <code>PropertyGroup</code>s manually.</p>

<pre><code>&lt;NoStdLib&gt;true&lt;/NoStdLib&gt;
</code></pre>

<h4>System.Web.Services</h4>

<p>After fixing the mscorlib.dll issues, though, I got a new error popping up. This final compile error was coming from code I wrote, so that was a good sign (I guess).</p>

<ul>
<li>Error: &#8220;The name &#8216;HttpUtility&#8217; does not exist in the current context&#8221;</li>
</ul>

<p>Since I am writing an application that interfaces almost entirely with the <a href="https://dev.sierratradingpost.com/">web-based JSON API</a> I wrote, there are a few places where I am sending back user content to that system. The URL encoding I use simply hits <code>HttpUtility.UrlEncode</code>. In MonoTouch, you need to make sure you <a href="https://stackoverflow.com/a/5398253/48700">reference <code>System.Web.Services</code> to get <code>UrlEncode</code></a>. But, in Visual Studio Land, the .NET 4.0+ DLL doesn&#8217;t have such a method. You can fix this issue with a static version reference on that DLL. There may be a version-agnostic way to do this, but I ended up editing my csproj file to point to the specific version found in the MonoTouch DLLs.</p>

<pre><code>&lt;Reference Include="System.Web.Services, Version=2.0.5.0" /&gt;
</code></pre>

<p>I will probably have to update this manually whenever a new version hits MonoTouch, but I definitely can live with that.</p>

<h3>VSMonoTouch In Use</h3>

<p>After getting the loading and compile errors worked out, I now have a MonoTouch solution building successfully in Visual Studio 2010. It contains a core project shared with the <a href="https://play.google.com/store/apps/details?id=com.sierratradingpost.android">Sierra Trading Post Android app</a> (using a few compiler directives) and my MonoTouch project containing almost entirely UI-related code. I write some code and it tells me whether it will compile correctly against the MonoTouch DLLs. I haven&#8217;t tried abusing the reliability of this system with any features that are not part of Mono (e.g., async/await) or MonoTouch (e.g., dynamic) yet.</p>

<p>Since my project is currently synced through Dropbox, I just save what I have on Windows and roll on over to the MacBook to run things on the simulator or deploy them to a physical device and/or <a href="https://www.testflightapp.com/">TestFlight</a> (which is far better than sliced bread, at least for getting your app out to multiple devices). MonoDevelop will even automatically update your project files if you already have it open, though I don&#8217;t recommend editing on both systems simultaneously without having something between them to handle conflicts that are bound to arise.</p>
												</div><!-- .entry-content --> 
								<footer class="entry-meta2">
		<span class="bl_tagg">Tagged <a href="../../tag/c-sharp/index.html" rel="tag">c#</a>, <a href="../../tag/ios/index.html" rel="tag">ios</a>, <a href="../../tag/monotouch/index.html" rel="tag">monotouch</a>, <a href="../../tag/visual-studio/index.html" rel="tag">visual studio</a></span>
 									</footer><!-- #entry-meta -->

	</article><!-- #post-222 -->
	
	

				
					
	<article id="post-213" class="post-213 post type-post status-publish format-standard hentry category-dev tag-c-sharp tag-ios tag-monotouch">
		<header class="entry-header">	
			<h2 class="entry-title">
				<a href="../../2012/10/05/creating-an-animated-spinner-in-a-monotouch-uiimageview/index.html" title="Permalink to Creating an animated spinner in a Xamarin.iOS (MonoTouch) UIImageView" rel="bookmark">
					Creating an animated spinner in a Xamarin.iOS (MonoTouch) UIImageView				</a>
			</h2>
						<div class="entry-meta">
				 <span class="author vcard" > By  <a class="url fn n" rel="author" href="../../author/adam/index.html" title="View all posts by adam">adam</a> <span class="bl_sep">|</span></span>  <time class="onDate date published" datetime="2012-10-05T12:59:49+00:00"> <a href="../../2012/10/05/creating-an-animated-spinner-in-a-monotouch-uiimageview/index.html" title="12:59 pm" rel="bookmark"><span class="entry-date">October 5, 2012</span> <span class="entry-time"> - 12:59 pm</span></a> </time><span class="bl_sep">|</span><time class="updated"  datetime="2012-10-05T12:59:49+00:00">October 5, 2012</time> <span class="bl_categ"> <a href="../../category/dev/index.html" rel="tag">dev</a> </span>  							<div class="comments-link">
				<a href="../../2012/10/05/creating-an-animated-spinner-in-a-monotouch-uiimageview/index.html#respond">Leave a comment</a>			</div>
						</div><!-- .entry-meta -->
			
		
		</header><!-- .entry-header -->
									<div class="entry-content">
						<h2>Background</h2>

<p>I&#8217;m well into my first week of building the Sierra Trading Post first iOS app using <a href="https://xamar.in/r/SierraTradingPost/xamarin.com/monotouch">Xamarin.iOS</a> and it has been a fun ride so far. One of the first things needed was a system for showing a loading image while asynchronously retrieving the final image with a web request.</p>

<h2>Attempt 1</h2>

<p>Xamarin has a recipe for using a <code>UIImageView</code>&#8216;s <code>AnimationImages</code> to make a spinner.</p>

<pre><code>UIImageView someImageView = new UIImageView();
someImageView.AnimationImages = new UIImage[] {
    UIImage.FromBundle("Spinning Circle_1.png"),
    UIImage.FromBundle("Spinning Circle_2.png"),
    UIImage.FromBundle("Spinning Circle_3.png"),
    UIImage.FromBundle("Spinning Circle_4.png"),
};
someImageView.AnimationRepeatCount = 0; // Repeat forever.
someImageView.AnimationDuration = 1.0; // Every 1s.
someImageView.StartAnimating();
</code></pre>

<p>It may be possible to make this work, but it wasn&#8217;t quite what I needed. This seems to be more of an image rotation than an animation. As a result, it creates a jerky animation between the various images equally distributed over the <code>AnimationDuration</code> you set.</p>

<p>After this, attempts to find some ideas for a better solution lead me to about a hundred lines of <a href="https://sabonrai.wordpress.com/2009/09/03/monotouch-sample-core-graphics-and-uiimageview/">code that proved a difficult to consume</a>, involving a <code>CGBitmapContext</code> and <code>CGAffineTransform.MakRotation</code>. (To be fair, this code isn&#8217;t doing something as simple as what I want to do.) Hoping to avoid that, I simply added four more rotation positions into the list. It would probably take many more to make it appear smooth. Any more than that and I really didn&#8217;t want to bloat my project with minute rotations of the same PNG. Back to Google I went.</p>

<h2>Solution</h2>

<p>After enough poking around some <a href="https://stackoverflow.com/questions/10054693/how-to-create-smooth-image-animation">slightly</a> <a href="https://docs.xamarin.com/ios/recipes/Animation/CoreAnimation/Create_an_Animation_Group">related</a> Google results, I began to understand enough of <code>CABasicAnimation</code> to see how it could work for the job. You create the desired animation and add an instance of <code>UIImageView.Layer</code>.</p>

<pre><code>    // Image to be rotated (in this case, found in the project as "/Assets/Images/loading_icon.png").
    UIImageView someImageView = new UIImageView(UIImage.FromBundle("Assets/Images/loading_icon"));
    CABasicAnimation rotationAnimation = CABasicAnimation.FromKeyPath("transform.rotation");
    rotationAnimation.To = NSNumber.FromDouble(Math.PI * 2); // full rotation (in radians)
    rotationAnimation.RepeatCount = int.MaxValue; // repeat forever
    rotationAnimation.Duration = 1;
    // Give the added animation a key for referencing it later (to remove, in this case).
    someImageView.Layer.AddAnimation(rotationAnimation, "rotationAnimation");
</code></pre>

<p>The main part of this is the simple rotation <code>CABasicAnimation</code> that is applied to a <code>Layer</code> of a <code>UIImageView</code>. In this case, it is set to do a full rotation (accepted in radians) every one second through a very large number of repetitions. The repetitions is actually one oddity in the switch to this new method. When you set <code>UIImageView.AnimationRepeatCount</code>, you can set it to zero to make it loop forever. Oddly, a <code>CABasicAnimation.RepeatCount</code> set to zero is the same as one, and it loops a single time before stopping.</p>

<h2>Code (Example doing for a bunch of UITableView cells)</h2>

<pre><code>static NSString key = new NSString("somecellkey");
public override UITableViewCell GetCell(UITableView tableView, NSIndexPath indexPath) {
    UITableViewCell cell = tableView.DequeueReusableCell(key);
    if (cell == null) {
        cell = new UITableViewCell(UITableViewCellStyle.Default, key);
    }

    // Image to be rotated (in this case, found in the project as "/Assets/Images/loading_icon.png").
    cell.ImageView.Image = UIImage.FromBundle("Assets/Images/loading_icon");
    CABasicAnimation rotationAnimation = CABasicAnimation.FromKeyPath("transform.rotation");
    rotationAnimation.To = NSNumber.FromDouble(Math.PI * 2); // full rotation (in radians)
    rotationAnimation.RepeatCount = int.MaxValue; // repeat forever
    rotationAnimation.Duration = 1;
    // Give the added animation a key for referencing it later (to remove, in this case).
    cell.ImageView.Layer.AddAnimation(rotationAnimation, "rotationAnimation");

    // Do your lazy-loading of the image (blog post coming soon...maybe).
    ...

    // For a good time, you can keep rotating your final, lazy-loaded image by not calling this line.
    cell.ImageView.Layer.RemoveAnimation("rotationAnimation");

    // Do the rest of your visual stuff to the cell.
    ...

    return cell;
}
</code></pre>

<h2>More Code</h2>

<p>If you want a quick demo application of the differences, check out the <a href="https://github.com/patridge/SpinnningUIImageView">GitHub repo</a> I put together [and finally got around to sharing]. It is a simple demo of two <code>UIImageView</code>s that implement the two methods here. Clicking anywhere will toggle between the two.</p>

<p>Here&#8217;s a quick video snippet of the demo code running.</p>

<iframe width="420" height="315" src="https://www.youtube.com/embed/vXp3akYh1Hk" frameborder="0" allowfullscreen></iframe>
												</div><!-- .entry-content --> 
								<footer class="entry-meta2">
		<span class="bl_tagg">Tagged <a href="../../tag/c-sharp/index.html" rel="tag">c#</a>, <a href="../../tag/ios/index.html" rel="tag">ios</a>, <a href="../../tag/monotouch/index.html" rel="tag">monotouch</a></span>
 									</footer><!-- #entry-meta -->

	</article><!-- #post-213 -->
	
	

				
					
	<article id="post-182" class="post-182 post type-post status-publish format-standard hentry category-dev tag-c-sharp tag-mono-for-android">
		<header class="entry-header">	
			<h2 class="entry-title">
				<a href="../../2012/07/11/mono-for-android-aapt-exe-exited-with-code-1/index.html" title="Permalink to Mono for Android: &#8220;aapt.exe&#8221; exited with code 1" rel="bookmark">
					Mono for Android: &#8220;aapt.exe&#8221; exited with code 1				</a>
			</h2>
						<div class="entry-meta">
				 <span class="author vcard" > By  <a class="url fn n" rel="author" href="../../author/adam/index.html" title="View all posts by adam">adam</a> <span class="bl_sep">|</span></span>  <time class="onDate date published" datetime="2012-07-11T18:26:32+00:00"> <a href="../../2012/07/11/mono-for-android-aapt-exe-exited-with-code-1/index.html" title="6:26 pm" rel="bookmark"><span class="entry-date">July 11, 2012</span> <span class="entry-time"> - 6:26 pm</span></a> </time><span class="bl_sep">|</span><time class="updated"  datetime="2012-07-11T18:26:32+00:00">July 11, 2012</time> <span class="bl_categ"> <a href="../../category/dev/index.html" rel="tag">dev</a> </span>  							<div class="comments-link">
				<a href="../../2012/07/11/mono-for-android-aapt-exe-exited-with-code-1/index.html#respond">Leave a comment</a>			</div>
						</div><!-- .entry-meta -->
			
		
		</header><!-- .entry-header -->
									<div class="entry-content">
						<h3>TL;DR</h3>

<p>Also available in <a href="https://stackoverflow.com/q/11440741/48700">TL;SO (too long; Stack Overflow) flavor</a>.</p>

<p>Getting this error: <code>"aapt.exe" exited with code 1</code>?</p>

<p>Do you have any files in your Mono for Android solution that are being packaged together with the app (e.g., &#8220;AndroidResource&#8221; build action)?</p>

<p>If so, make sure they don&#8217;t have anything but letters, numbers, periods, and underscores ([a-z0-9_.]) in their names.</p>

<h3>Details</h3>

<p>I am still getting my feet wet with Mono for Android (MfA) development. One of my first projects was a <a href="https://github.com/patridge/MonoForAndroidFlashlight">flashlight app</a> for my Galaxy Nexus that introduced me to <a href="https://stackoverflow.com/q/6881004/48700">a</a> <a href="https://stackoverflow.com/q/10757138/48700">couple</a> Android/MfA development quirks. One concept in app development that I would like to explore is long-running tasks. How do I keep something going after the user has switched off to something else?</p>

<p>Greg Shackles has a new <a href="https://visualstudiomagazine.com/Articles/2012/07/10/Background-Services-in-Mono-for-Android.aspx?Page=1">Visual Studio Magazine article on Background Services in MfA</a> on just that topic. He creates a background service for playing an MP3 file using a standard Android service.</p>

<p>In his sample project, he sets up the service to play some Creative Commons <a href="https://www.nin.com/albums/">Nine Inch Nails music</a>.</p>

<blockquote class="twitter-tweet"><p>I&#8217;m betting that I&#8217;m the first person to use (and include in the sample) a Nine Inch Nails song for Visual Studio Magazine. <a href="https://twitter.com/search/%2523winning">#winning</a></p>&mdash; Greg Shackles (@gshackles) <a href="https://twitter.com/gshackles/status/222768944459685890" data-datetime="2012-07-10T19:07:09+00:00">July 10, 2012</a></blockquote>

<p>I happen to have a good collection of my own Nine Inch Nails music. As I put the code together in my own project, I grabbed one such MP3 file, named &#8220;02 1,000,000.mp3&#8221;, and added it with the &#8220;AndroidResource&#8221; Build Action. Unfortunately, hitting <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>B</kbd> resulted in a lovely error: <code>"aapt.exe" exited with code 1</code>.</p>

<p><a href="../../wp-content/uploads/2012/07/BuildError.png"><img src="../../wp-content/uploads/2012/07/BuildError-300x127.png" alt="" title="Build Error" width="300" height="127" class="alignnone size-medium wp-image-187" /></a></p>

<p>If you go to the Visual Studio output window, you don&#8217;t find much else of value.</p>

<p><a href="../../wp-content/uploads/2012/07/MinimalMsbuildLogOutput.png"><img src="../../wp-content/uploads/2012/07/MinimalMsbuildLogOutput-300x165.png" alt="" title="Minimal MsBuild Log Output" width="300" height="165" class="alignnone size-medium wp-image-185" /></a></p>

<p>Fortunately, you can get more verbose output from MSBuild if you ask for it. In the Visual Studio Options, go to &#8220;Projects and Solutions&#8221; then &#8220;Build and Run&#8221;. Switch the &#8220;MSBuild project build output verbosity&#8221; from &#8220;Minimal&#8221; to &#8220;Normal&#8221;. After I built the project again, I got a little clearer message: <code>res\raw\02 1,000,000.mp3: Invalid file name: must contain only [a-z0-9_.]</code>.</p>

<p><a href="../../wp-content/uploads/2012/07/NormalMsbuildLogOutput.png"><img src="../../wp-content/uploads/2012/07/NormalMsbuildLogOutput-300x164.png" alt="" title="Normal MsBuild Log Output" width="300" height="164" class="alignnone size-medium wp-image-191" /></a></p>

<p>A quick name change to something within the <code>[a-z0-9_.]</code> range and the project built beautifully. While this new sample project is just a horrible version of the baked-in music application, that definitely isn&#8217;t the point. It is definitely nice to have some code written about a concept before you find yourself needing it the first time.</p>
												</div><!-- .entry-content --> 
								<footer class="entry-meta2">
		<span class="bl_tagg">Tagged <a href="../../tag/c-sharp/index.html" rel="tag">c#</a>, <a href="../../tag/mono-for-android/index.html" rel="tag">Mono for Android</a></span>
 									</footer><!-- #entry-meta -->

	</article><!-- #post-182 -->
	
	

				
					
	<article id="post-176" class="post-176 post type-post status-publish format-standard hentry category-dev tag-c-sharp tag-ihtmlstring tag-json tag-json-net">
		<header class="entry-header">	
			<h2 class="entry-title">
				<a href="../../2012/07/05/where-did-that-json-field-go-serializing-ihtmlstring-to-json/index.html" title="Permalink to Where did that JSON field go? Serializing IHtmlString to JSON." rel="bookmark">
					Where did that JSON field go? Serializing IHtmlString to JSON.				</a>
			</h2>
						<div class="entry-meta">
				 <span class="author vcard" > By  <a class="url fn n" rel="author" href="../../author/adam/index.html" title="View all posts by adam">adam</a> <span class="bl_sep">|</span></span>  <time class="onDate date published" datetime="2012-07-05T12:26:17+00:00"> <a href="../../2012/07/05/where-did-that-json-field-go-serializing-ihtmlstring-to-json/index.html" title="12:26 pm" rel="bookmark"><span class="entry-date">July 5, 2012</span> <span class="entry-time"> - 12:26 pm</span></a> </time><span class="bl_sep">|</span><time class="updated"  datetime="2012-07-05T12:26:17+00:00">July 5, 2012</time> <span class="bl_categ"> <a href="../../category/dev/index.html" rel="tag">dev</a> </span>  							<div class="comments-link">
				<a href="../../2012/07/05/where-did-that-json-field-go-serializing-ihtmlstring-to-json/index.html#comments">1 Comment</a>			</div>
						</div><!-- .entry-meta -->
			
		
		</header><!-- .entry-header -->
									<div class="entry-content">
						<h2>TL;DR</h2>

<p>If your brain consumes Stack Overflow questions better than blog posts, go see <a href="https://stackoverflow.com/q/11350392/48700">&#8220;How do I serialize IHtmlString to JSON with Json.NET?&#8221;</a> over there.</p>

<h2>IHtmlString doesn&#8217;t play nicely with JSON serialization</h2>

<p>If you have an IHtmlString in your JSON (regardless of arguments against putting raw HTML in JSON), you will probably need to customize the serialization to get the HTML out of that variable. In fact, the serialization will probably be invalid compared to what you expect; it does make sense if you think about how the serialization process works.</p>

<p>Fortunately, putting together a quick Json.NET <code>JsonConverter</code> will make the issue go away.</p>

<p>What you might expect from some object containing an <code>IHtmlString</code> variable named <code>x</code>:</p>

<pre><code>{ x = "some &lt;span&gt;text&lt;/span&gt;" }
</code></pre>

<p>What default .NET JavaScript serialization and default Json.NET serialization will give you for said object:</p>

<pre><code>{ x = { } }
</code></pre>

<p>How to fix it with Json.NET:</p>

<pre><code>public class IHtmlStringConverter : Newtonsoft.Json.JsonConverter {
    public override bool CanConvert(Type objectType) {
        return typeof(IHtmlString).IsAssignableFrom(objectType);
    }
    ...
    public override void WriteJson(Newtonsoft.Json.JsonWriter writer, object value, Newtonsoft.Json.JsonSerializer serializer) {
        IHtmlString source = value as IHtmlString;
        if (source == null) {
            return;
        }
        writer.WriteValue(source.ToString());
    }
}
</code></pre>

<h2>Background</h2>

<p>While working on <a href="https://dev.sierratradingpost.com/">some random API</a>, we noticed one of our JSON fields went from being a long string containing raw HTML (legacy baggage) to an empty object: <code>SomeFieldWithHtml: {}</code>.</p>

<p>While the API JSON-generating code hadn&#8217;t changed, that field was pulled from code shared by our MVC website. It seems that field was converted directly to an IHtmlString to avoid doubly-encoding it in an MVC view. If you ever have the same issue, you can avoid this issue entirely by leaving the source as a string and doing a quick <code>MvcHtmlString.Create(x)</code> on it before sending it to your view/view-model.</p>

<h2>Code</h2>

<p>For the full source used in this post, including an example MVC project where a controller has action methods to test all the variations here, head over to <a href="https://github.com/patridge/JsonNetIHtmlStringTesting">this post&#8217;s GitHub repository</a>.</p>
												</div><!-- .entry-content --> 
								<footer class="entry-meta2">
		<span class="bl_tagg">Tagged <a href="../../tag/c-sharp/index.html" rel="tag">c#</a>, <a href="../../tag/ihtmlstring/index.html" rel="tag">ihtmlstring</a>, <a href="../../tag/json/index.html" rel="tag">json</a>, <a href="../../tag/json-net/index.html" rel="tag">json.net</a></span>
 									</footer><!-- #entry-meta -->

	</article><!-- #post-176 -->
	
	

				
					
	<article id="post-161" class="post-161 post type-post status-publish format-standard hentry category-dev tag-c-sharp tag-performance tag-performance-stub">
		<header class="entry-header">	
			<h2 class="entry-title">
				<a href="../../2012/04/11/performance-stub-getting-all-subtype-items-from-a-list/index.html" title="Permalink to Performance Stub: getting all subtype items from a list" rel="bookmark">
					Performance Stub: getting all subtype items from a list				</a>
			</h2>
						<div class="entry-meta">
				 <span class="author vcard" > By  <a class="url fn n" rel="author" href="../../author/adam/index.html" title="View all posts by adam">adam</a> <span class="bl_sep">|</span></span>  <time class="onDate date published" datetime="2012-04-11T07:51:28+00:00"> <a href="../../2012/04/11/performance-stub-getting-all-subtype-items-from-a-list/index.html" title="7:51 am" rel="bookmark"><span class="entry-date">April 11, 2012</span> <span class="entry-time"> - 7:51 am</span></a> </time><span class="bl_sep">|</span><time class="updated"  datetime="2012-04-11T07:51:28+00:00">April 11, 2012</time> <span class="bl_categ"> <a href="../../category/dev/index.html" rel="tag">dev</a> </span>  							<div class="comments-link">
				<a href="../../2012/04/11/performance-stub-getting-all-subtype-items-from-a-list/index.html#respond">Leave a comment</a>			</div>
						</div><!-- .entry-meta -->
			
		
		</header><!-- .entry-header -->
									<div class="entry-content">
						<h2>Performance Stubs</h2>

<p>These blog posts are simply times I wanted to identify the fastest method for accomplishing a particular goal. As I write the code, I like to make some light notes of alternatives while driving forward with the first implementation that makes it from my brain to my fingers.</p>

<p>When I get the chance, I can go back and flesh out the two versions and drop them into some basic <code>Stopwatch</code> timing to determine which is better in terms of raw speed. Factoring those results with clarity of code, I have a method I will likely choose the next time I need the same feature.</p>

<h2>Goal</h2>

<p>Given a particular <code>IEnumerable</code>, find all the elements that are of a particular type (subclass, in this case).</p>

<h3>Method 1: Select As, Where Not Null</h3>

<p>The <a href="https://msdn.microsoft.com/en-us/library/cscsdfbt(v=vs.71).aspx"><code>as</code> operator</a> with convert between two types with one nice tweak. If the cast cannot happen, it results in <code>null</code>.</p>

<p>In this version, we massage the list by hitting all items with an <code>as</code> cast and then filter out the ones that didn&#8217;t cast successfully.</p>

<pre><code>public static IEnumerable&lt;SubSomething&gt; SelectAsWhereNotNull(IEnumerable&lt;Something&gt; source) {
    return source.Select(item =&gt; item as SubSomething).Where(item =&gt; item != null);
}
</code></pre>

<h3>Method 2: Where Is, Cast</h3>

<p>There is also the <a href="https://msdn.microsoft.com/en-us/library/scekt9xw(v=vs.71).aspx"><code>is</code> operator</a>. Instead of returning a cast result, it simply returns a boolean for whether the instance can be cast as a given type. From there, we use another <code>Linq</code> extension method: <a href="https://msdn.microsoft.com/en-us/library/bb341406.aspx"><code>Cast&lt;TResult&gt;</code></a>.</p>

<p>In this version, we filter the original list to just those that can make the cast successfully, then <code>Cast</code> those items to the final desired type.</p>

<pre><code>public static IEnumerable&lt;SubSomething&gt; WhereIsCast(IEnumerable&lt;Something&gt; source) {
    return source.Where(item =&gt; item is SubSomething).Cast&lt;SubSomething&gt;();
}
</code></pre>

<h2>Test</h2>

<p>I built up a list (n=1,000,000) of parent type <code>Something</code> but make every other item a <code>SubSomething</code> (which is a subclass of <code>Something</code>). Then, I run that list through both methods 1000 iterations each.</p>

<h2>Results</h2>

<h3>Clarity</h3>

<p>Neither method is particularly difficult to decipher. The <code>Select</code>/<code>Where</code> method takes a few more characters, but not enough to hurt.</p>

<h3>Speed</h3>

<p>It takes quite a list for these tests to even register with average <a href="https://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx">ticks</a>. That said, there is little gain to be had here over small lists. Once list lengths are sufficiently large, method 1 took the lead.</p>

<table>
  <caption>For n=1,000,000 and 1000 iterations (run on 2.4GHz AMD Phenom 9750 with 8GB RAM)</caption>
  <tr>
    <th>Average</th>
    <th>Method</th>
  </tr>
  <tr>
    <td>1.0 ticks</td>
    <td><code>{IEnumerable&lt;Something&gt;}.Select(item =&gt; item as SubSomething).Where(item => item != null)</code></td>
  </tr>
  <tr>
    <td>1.7 ticks</td>
    <td><code>{IEnumerable&lt;Something&gt;}.Where(item => item is SubSomething).Cast&lt;SubSomething&gt;()</code></td>
  </tr>
</table>

<h2>Performance Testing Framework</h2>

<p>The original source for the test framework code evolved from a <a href="https://stackoverflow.com/questions/311165/how-do-you-convert-byte-array-to-hexadecimal-string-and-vice-versa-in-c/624379#624379">StackOverflow answer about converting byte arrays to hexadecimal strings</a>. &#8211;That code is available in a <a href="https://bitbucket.org/patridge/convertbytearraytohexstringperftest">bitbucket repo</a>. I have adapted it here for these two methods.&#8211; That code is available in the <a href="https://github.com/patridge/PerformanceStubs">framework repo</a>.</p>

<p>Rather than post another repo for each test, I am going to abstract out a testing framework for these posts. That repo will show up soon and I will update this post accordingly.</p>

<h3>Update 2013-01-22</h3>

<p>I finally refined the testing framework code I was using. While I won&#8217;t pretend this code couldn&#8217;t use some improvements, feel free to hack away with it. The code is <a href="https://github.com/patridge/PerformanceStubs">available on GitHub</a>.</p>

<p>To add a new case to an existing test:</p>

<ol>
<li>Add the new static method (<code>Func&lt;byte[], string&gt;</code>) to /Tests/ConvertByteArrayToHexString/Test.cs.</li>
<li>Add that method&#8217;s name to the <code>TestCandidates</code> return value in that same class.</li>
<li>Make sure you are running the input version you want, sentence or text, by toggling the comments in <code>GenerateTestInput</code> in that same class.</li>
<li>Hit <kbd>F5</kbd> and wait for the output (an HTML dump is also generated in the /bin folder).</li>
</ol>

<p>To add a new test fixture entirely, just write up something that implements IPerformanceTest in that project&#8217;s namespace.</p>
												</div><!-- .entry-content --> 
								<footer class="entry-meta2">
		<span class="bl_tagg">Tagged <a href="../../tag/c-sharp/index.html" rel="tag">c#</a>, <a href="../../tag/performance/index.html" rel="tag">performance</a>, <a href="../../tag/performance-stub/index.html" rel="tag">performance stub</a></span>
 									</footer><!-- #entry-meta -->

	</article><!-- #post-161 -->
	
	

				
					<div class='pagination_container'><nav class='pagination'><a href='../../index.html'>&laquo;</a><a href='../4/index.html'>&lsaquo;</a><a href='../3/index.html' class='inactive' >3</a><a href='../4/index.html' class='inactive' >4</a><span class='current'>5</span><a href='../6/index.html' class='inactive' >6</a><a href='../7/index.html' class='inactive' >7</a><a href='../6/index.html'>&rsaquo;</a><a href='../7/index.html'>&raquo;</a></nav></div>

			
			</div><!-- #content -->
			<div id="primary" class="widget-area" role="complementary">

		
		
			<ul class="xoxo">
				<li id="search-2" class="widget-container widget_search"><form method="get" id="searchform" action="https://www.patridgedev.com/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="s" placeholder="Search" value="" name="s" />
	</label>
	<button type="submit" class="searchsubmit"><span class="screen-reader-text">Search</span>OK</button>
</form>
</li>		<li id="recent-posts-2" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="../../2019/09/27/copy-command-line-output-to-the-clipboard-on-macos-windows-and-linux/index.html">Copy command line output to the clipboard on macOS, Windows, and Linux</a>
									</li>
											<li>
					<a href="../../2019/08/06/determine-sha-hash-of-file-on-windows-linux-and-macos/index.html">Determine SHA hash of file on Windows, Linux, and macOS</a>
									</li>
											<li>
					<a href="../../2019/05/20/workaround-xamarin-android-long-paths-on-windows/index.html">Workaround: Xamarin.Android long paths on Windows</a>
									</li>
											<li>
					<a href="../../2019/02/06/play-japanese-famicom-games-with-your-us-nintendo-switch-online-account/index.html">Play Japanese Famicom games with your US Nintendo Switch Online account</a>
									</li>
											<li>
					<a href="../../2018/10/29/fallback-variables-in-dotnet-new-templates/index.html">Fallback variables in `dotnet new` templates</a>
									</li>
					</ul>
		</li><li id="text-3" class="widget-container widget_text">			<div class="textwidget"><p><!--Amazon--><br />
<iframe src="https://rcm-na.amazon-adsystem.com/e/cm?t=pricetrack-20&o=1&p=9&l=ez&f=ifr&f=ifr&linkID=U4QK3RSRY7VEZR26" scrolling="no" marginwidth="0" marginheight="0" border="0" frameborder="0" style="border:none;"></iframe></p>
</div>
		</li>			</ul>

			<ul class="xoxo">
				<li id="text-2" class="widget-container widget_text"><h3 class="widget-title">PatridgeDev elsewhere</h3>			<div class="textwidget"><p><a href="https://stackoverflow.com/users/48700/patridge"><br />
<img src="https://stackoverflow.com/users/flair/48700.png" width="208" height="58" alt="profile for patridge at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for patridge at Stack Overflow, Q&amp;A for professional and enthusiast programmers"><br />
</a>
</div>
<div>
<a href="https://xamarin.com/mvp"><img src="../../wp-content/uploads/2015/04/MVP-Badge2-300x127.png" alt="Xamarin MVP" style="width:200px;"/></a>
</div>
<div>
<a href="https://university.xamarin.com/certification"><img src="../../wp-content/uploads/2015/04/Xamarin-Ceritified-Mobile-Developer-Badge-small-res.png" alt="Xamarin Certified Mobile Developer" style="width:150px;"/></a>
</div>
<div>
<a class="twitter-timeline" href="https://twitter.com/PatridgeDev?ref_src=twsrc%5Etfw">Tweets by PatridgeDev</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
		</li>			</ul>

			
		</div><!-- #primary .widget-area -->

			</section><!-- #container -->
	<div style="clear:both;"></div>

	</div> <!-- #forbottom -->
	</div><!-- #main -->


	<footer id="footer" role="contentinfo">
		<div id="colophon">
		
			

	<div id="footer-widget-area"  role="complementary"  class="footerone" >

	
			<div id="second" class="widget-area">
			<ul class="xoxo">
				<li id="text-5" class="widget-container widget_text">			<div class="textwidget"><div id="amzn-assoc-ad-d543690b-5196-4e42-ab6e-dc8f3891227e"></div>
<p><script async src="https://z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=d543690b-5196-4e42-ab6e-dc8f3891227e"></script></p>
</div>
		</li>			</ul>
		</div><!-- #second .widget-area -->
	
	
		
	</div><!-- #footer-widget-area -->
			
		</div><!-- #colophon -->

		<div id="footer2">
		
			<div style="text-align:center;clear:both;padding-top:4px;" >
	<a href="../../index.html" title="PatridgeDev" rel="home">
		PatridgeDev</a> | Powered by <a target="_blank" href="https://www.cryoutcreations.eu/mantra" title="Mantra Theme by Cryout Creations">Mantra</a>
</div><!-- #site-info --> 	<div class="socials" id="sfooter"> 
	
			<a target="_blank" rel="nofollow" href="https://twitter.com/patridgedev" class="socialicons social-Twitter" title="Twitter">
				<img alt="Twitter" src="../../wp-content/themes/mantra.3.2.0_custom/resources/images/socials/Twitter.png" />
			</a>
            	</div>
				
		</div><!-- #footer2 -->

	</footer><!-- #footer -->

</div><!-- #wrapper -->

<script type='text/javascript' src='../../wp-includes/js/wp-embed.mine6b3.js?ver=5.4.11'></script>

</body>
</html>
